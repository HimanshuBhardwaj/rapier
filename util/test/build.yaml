title: Build API
version: "0.1"
conventions:
  selector_location: path-segment
entities:
  Builder:
    well_known_URLs: /builder
    query_paths: 
    - buildRequests 
    - buildRequests;{name} 
    - buildRequests;{name}/spec 
    allOf:
    - $ref: '#/non_entities/Resource'
    readOnly: true
    properties:
      kind:
        type: string
        enum: [Builder]
      buildRequests:
        format: uri
        type: string
        readOnly: true
        relationship:
          collection_resource: '#Collection'
          entities: '#BuildRequest'
          multiplicity: 0:n
          consumes: multi-part/form-data 
  BuildRequest:
    allOf:
    - $ref: '#/non_entities/PersistentResource'
    properties:
      name:
        type: string
      kind:
        type: string
        enum: [BuildRequest]
      environment:
        format: uri
        type: string
        relationship: '#Environment'
      zip_contents:
        type: string    
      status:
        type: string
        enum: [building, done, failed]
      spec:
        format: uri
        type: string
        relationship: '#PodTemplateSpec'
  Environment:
    readOnly: true
  PodTemplateSpec:
    readOnly: true
non_entities:
  PersistentResource:
    allOf:
    - $ref: '#/non_entities/Resource'
    type: object
    properties:
      created:
        type: string
        format: date-time
        readOnly: true
      creator:
        type: string
        format: URL
        readOnly: true
      modified:
        type: string
        format: date-time
        readOnly: true
      modifier:
        type: string
        format: date-time
        readOnly: true
  Resource:
    type: object
    properties:
      self:
        type: string
      kind:
        type: string
  Collection:
    allOf:
    - $ref: '#/non_entities/Resource'
    properties:
      kind:
        type: string
        enum: [Collection]
      items:
        type: array
        items: 
          type: object
    readOnly: true
