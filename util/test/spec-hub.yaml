title: Spec Hub API
version: "0.1"
consumes: application/json
produces: application/json text/html
conventions:
  multi_valued_relationships:
    entities: '#/entities/Collection #/entities/Page'
  patch_consumes: application/merge-patch+json
  error_response:
    type: string
securityDefinitions:
  sso:
    type: oauth2
    scopes: {}
    flow: application
    tokenUrl: whatever
security:
- sso: []
entities:
  Resource:
    abstract: true
    type: object
    properties:
      self:
        type: string
        readOnly: true
      kind:
        type: string
  PersistentResource:
    allOf:
    - $ref: '#/entities/Resource'
    abstract: true
    properties:
      created:
        type: string
        format: date-time
        readOnly: true
      creator:
        type: string
        format: URL
        readOnly: true
      modified:
        type: string
        format: date-time
        readOnly: true
      modifier:
        type: string
        format: date-time
        readOnly: true
    abstract: true
  Collection:
    allOf:
    - $ref: '#/entities/Resource'
    properties:
      kind:
        type: string
        enum: [Collection]
      items:
        type: array
        items: 
          type: object
    query_parameters:
    - name: properties
      items:
        type: string
      type: array
      required: false
    - name: limit
      type: integer
      minimum: 1
      maximum: 1000
      required: false
    - name: orderby
      type: string
    - name: direction
      type: string
      required: false
      enum: ['ascending', 'descending']
    readOnly: true
  Page:
    allOf:
    - $ref: '#/entities/Resource'
    properties:
      kind:
        type: string
        enum: [Page]
      item_type: 
        type: string
      items:
        type: array
        items: 
          type: object
      collection:
        type: string
        format: uri
    query_parameters:
    - name: properties
      items:
        type: string
      type: array
      required: false
    - name: limit
      type: integer
      minimum: 1
      maximum: 1000
      required: false
    readOnly: true
  Hub:
    allOf:
    - $ref: '#/entities/Resource'
    properties:
      kind:
        type: string
        enum: [Hub]
    well_known_URLs: /
    query_paths: 
    - myHub
    - sharedWithMe
    - things
    - segments: Zmxk;{implementation_key}
      discriminator_separator: "-"
    - segments: Zmxk;{implementation_key}/contents
      discriminator_separator: "-"
    - segments: c3Bj;{implementation_key}
      discriminator_separator: "-"
    - segments: c3Bj;{implementation_key}/content
      discriminator_separator: "-"
    readOnly: true
  Folder:
    allOf:
    - $ref: '#/entities/PersistentResource'
    query_paths: [contents]
    properties:
      kind:
        type: string
        enum: [Folder]
      name:
        type: string
      permissions:
        type: array
        items: 
          properties:
            actor:
              format: URL
              type: string
            action:
              type: string
      implementation_key:
        implementation_private: true
        type: integer  
  Spec:
    allOf:
    - $ref: '#/entities/PersistentResource'
    query_paths: [content]
    properties:
      kind:
        type: string
        enum: [Spec]
      name:
        type: string
      permissions:
        type: array
        items: 
          properties:
            actor:
              format: URL
              type: string
            action:
              type: string
      implementation_key:
        implementation_private: true
        type: integer  
  Content:
    type: string
    consumes: application/x-yaml text/yaml text/html text/plain
    produces: application/x-yaml text/yaml text/html text/plain
relationships:
  hub-to-my-folder:
    one_end:
      entity: '#Hub'
      property: myHub
      multiplicity: '1:1'
    other_end:
      entity: '#Folder'
  hub-to-shared-folder:
    one_end:
      entity: '#Hub'
      property: sharedWithMe
      multiplicity: 0:n
      readOnly: true
    other_end:
      entity: '#Folder'
  hub-to-shared-spec:
    one_end:
      entity: '#Hub'
      property: sharedWithMe
      multiplicity: 0:n
      readOnly: true
    other_end:
      entity: '#Spec'
  folder-to-spec:
    one_end:
      entity: '#Folder'
      property: contents
      multiplicity: 0:n
    other_end:
      entity: '#Spec'
      property: folder
      multiplicity: 0:1
      collection_resource: false
  folder-to-folder:
    one_end:
      entity: '#Folder'
      property: contents
      multiplicity: 0:n
    other_end:
      entity: '#Folder'
      property: folder
      multiplicity: 0:1
      collection_resource: false
  spec-to-content:
    one_end:
      entity: '#Spec'
      property: content
      multiplicity: 0:1
    other_end:
      entity: '#Content'
  page-to-next-page:
    one_end:
      entity: '#Page'
      property: next_page
      multiplicity: 0:1
      readOnly: True
    other_end:
      entity: '#Page'
  page-to-previous-page:
    one_end:
      entity: '#Page'
      property: previous_page
      multiplicity: 0:1
      readOnly: True
    other_end:
      entity: '#Page'
  hub-to-spec:
    one_end:
      entity: '#Hub'
      property: things
      multiplicity: 0:n
    other_end:
      entity: '#Spec'
  hub-to-things:
    one_end:
      entity: '#Hub'
      property: things
      multiplicity: 0:n
    other_end:
      entity: '#Folder'
  hub-to-folders:
    one_end:
      implementation_private: true
      entity: '#Hub'
      property: Zmxk
      multiplicity: 0:n
    other_end:
      entity: '#Folder'
  hub-to-specs:
    one_end:
      implementation_private: true
      entity: '#Hub'
      property: c3Bj
      multiplicity: 0:n
    other_end:
      entity: '#Spec'
